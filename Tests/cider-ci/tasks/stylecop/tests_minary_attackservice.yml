      tasks:
        stylecop_minary_attackservice:
          timeout: 300
          name: Style checks Minary Attack service 
          
          trial-attachments:
            logs:
             include-match: ^attachment[\w\d\-\_]*\.log$
             content-type: text/plain
          
          scripts:
            run_nuget_restore:
              body: |
                start /w .nuget\nuget.exe restore
                echo nuget.exe error level is %ERRORLEVEL%
                exit /b %ERRORLEVEL%

            build_tests_minary_attackservice:
              ignore-state: false
              start-when:
                - script: run_nuget_restore   
                  states: [passed] 
              body: |
                start /w msbuild tests\TestsMinaryAttackServices\TestsMinaryAttackServices.csproj /t:Build /p:Configuration="Debug" /p:Platform="Mixed Platforms" /p:OutputPath=bin\Debug /flp:Summary;Verbosity=minimal;LogFile=attachment-msbuild-info_tests_minary_attackservice.log /flp1:logfile=attachment-msbuild-error_tests_minary_attackservice.log;errorsonly /flp2:logfile=attachment-msbuild-warning_tests_minary_attackservice.log;warningsonly
                exit /b %ERRORLEVEL%

            # Evaluate outputfiles, check for StyleCop records
            codingconvenctions_tests_minary_attackservice:
              ignore-state: false
              start-when:
                - script: build_tests_minary_attackservice   
                  states: [passed]                
              body: |
                if not exist "attachment-msbuild-warning_tests_minary_attackservice.log" exit /b 1
                type "attachment-msbuild-warning_tests_minary_attackservice.log" | find /c "warning : SA" > temp_tests_minary_attackservice.txt    
                set /p VAR=<temp_tests_minary_attackservice.txt
                del temp_tests_minary_attackservice.txt
                if %VAR% gtr 0 exit /b 2
                exit /b 0
                